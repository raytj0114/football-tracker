# Football Tracker (ベータ版) 仕様書

## 概要

サッカー情報を表示するWebアプリケーション。Football-Data.org APIからデータを取得し、試合情報、順位表、チーム情報をユーザーに提供します。

---

## ページ構成

### 1. ホームページ (`/`)

**表示内容:**

- アプリのロゴとタイトル
- 利用可能なリーグ一覧（カード形式）
- 各リーグのエンブレム、名称、所属国

**操作:**
| ボタン/リンク | 遷移先 | 説明 |
|-------------|--------|------|
| リーグカードの「試合」ボタン | `/matches?league={code}` | 該当リーグの試合一覧を表示 |
| リーグカードの「順位表」ボタン | `/standings?league={code}` | 該当リーグの順位表を表示 |
| ヘッダーの「試合」リンク | `/matches` | デフォルトリーグ（PL）の試合一覧 |
| ヘッダーの「順位表」リンク | `/standings` | デフォルトリーグ（PL）の順位表 |
| ヘッダーの「お気に入り」リンク | `/favorites` | お気に入りチーム一覧（要ログイン） |
| ヘッダーのログインボタン | `/login` | ログインページ |

---

### 2. 試合一覧ページ (`/matches`)

**表示内容:**

- リーグセレクター（タブ形式）
- リーグ情報ヘッダー（エンブレム、名称、試合数）
- フィルター・ソートコントロール
- 試合カード一覧

**フィルター機能:**
| フィルター | オプション | 説明 |
|-----------|-----------|------|
| ステータス | すべて / ライブ / 予定 / 終了 | 試合状態でフィルタリング |
| 期間 | すべて / 今日 / 明日 / 今週 / 過去 / カスタム | 日付でフィルタリング |
| ソート | 古い順 / 新しい順 | 試合日時でソート |

**操作:**
| ボタン/リンク | 遷移先 | 説明 |
|-------------|--------|------|
| リーグタブ | `/matches?league={code}` | 選択したリーグの試合一覧に切り替え |
| チーム名 | `/teams/{id}` | チーム詳細ページ |
| フィルタをクリア | - | フィルターをリセット |
| カスタム期間「適用」ボタン | - | 指定した期間でフィルタリング |

---

### 3. 順位表ページ (`/standings`)

**表示内容:**

- リーグセレクター（タブ形式）
- リーグ情報ヘッダー
- 順位表テーブル

**順位表の列:**
| 列 | 説明 |
|----|------|
| 順位 | 現在の順位 |
| チーム | チームのエンブレムと名称 |
| 試合 | 総試合数 |
| 勝 | 勝利数 |
| 分 | 引き分け数 |
| 負 | 敗北数 |
| 得点 | 総得点 |
| 失点 | 総失点 |
| 得失点差 | 得点 - 失点 |
| 勝点 | 総勝ち点 |
| 直近5試合 | 直近5試合の結果（W/D/L） |

**ゾーン表示:**

- 緑: チャンピオンズリーグ出場圏
- 青: ヨーロッパリーグ出場圏
- 黄: カンファレンスリーグ出場圏
- 赤: 降格圏

**操作:**
| ボタン/リンク | 遷移先 | 説明 |
|-------------|--------|------|
| リーグタブ | `/standings?league={code}` | 選択したリーグの順位表に切り替え |
| チーム名 | `/teams/{id}` | チーム詳細ページ |

---

### 4. チーム詳細ページ (`/teams/{id}`)

**表示内容:**

- チームヘッダー（エンブレム、名称、創設年、スタジアム）
- タブナビゲーション
- 選手一覧または試合一覧

**タブ:**
| タブ | 表示内容 |
|-----|---------|
| 選手 | 所属選手一覧（ポジション別） |
| 試合 | チームの試合一覧 |

**操作:**
| ボタン/リンク | 遷移先 | 説明 |
|-------------|--------|------|
| お気に入り登録ボタン | - | チームをお気に入りに追加（要ログイン） |
| お気に入り解除ボタン | - | チームをお気に入りから削除 |
| タブ切り替え | - | 表示内容を切り替え |

---

### 5. お気に入りページ (`/favorites`)

**アクセス条件:** ログイン必須

**表示内容:**

- 登録済みお気に入りチーム一覧
- 各チームのエンブレムと名称

**操作:**
| ボタン/リンク | 遷移先 | 説明 |
|-------------|--------|------|
| チームカード | `/teams/{id}` | チーム詳細ページ |
| 削除ボタン | - | お気に入りから削除 |

**未登録時:**

- 「お気に入りチームがありません」メッセージ
- チーム検索リンクを表示

---

### 6. ログインページ (`/login`)

**表示内容:**

- アプリロゴ
- Google認証ボタン
- エラーメッセージ（認証失敗時）

**操作:**
| ボタン/リンク | 動作 | 説明 |
|-------------|------|------|
| Googleでログイン | Google OAuth認証開始 | Googleアカウントで認証 |
| ログインせずに続ける | `/` | ホームページに戻る |

**認証成功時:**

- 元のページ（callbackUrl）にリダイレクト
- デフォルトはホームページ

---

## 共通UIコンポーネント

### ヘッダー

**表示内容:**

- アプリロゴ（ホームへリンク）
- ナビゲーションリンク
- テーマ切り替えボタン
- ユーザーメニュー（ログイン時）

**操作:**
| ボタン/リンク | 遷移先/動作 | 説明 |
|-------------|------------|------|
| ロゴ | `/` | ホームページ |
| 試合 | `/matches` | 試合一覧 |
| 順位表 | `/standings` | 順位表 |
| お気に入り | `/favorites` | お気に入り（要ログイン） |
| テーマ切り替え | - | ライト/ダークモード切り替え |
| ログイン | `/login` | ログインページ |
| ログアウト | - | セッション終了、ホームへリダイレクト |

### サイドバー（デスクトップ）

**表示内容:**

- ナビゲーションリンク
- リーグ一覧
- お気に入りチームへのクイックアクセス（ログイン時）

---

## 対応リーグ

| コード | リーグ名         | 国           |
| ------ | ---------------- | ------------ |
| PL     | Premier League   | イングランド |
| BL1    | Bundesliga       | ドイツ       |
| SA     | Serie A          | イタリア     |
| PD     | La Liga          | スペイン     |
| FL1    | Ligue 1          | フランス     |
| CL     | Champions League | ヨーロッパ   |

---

## 試合ステータス

| ステータス | 表示   | 説明                 |
| ---------- | ------ | -------------------- |
| SCHEDULED  | 予定   | 試合予定             |
| TIMED      | 予定   | 時間確定済み         |
| IN_PLAY    | ライブ | 試合中（前半・後半） |
| PAUSED     | ライブ | ハーフタイム         |
| FINISHED   | 終了   | 試合終了             |
| POSTPONED  | 延期   | 試合延期             |
| CANCELLED  | 中止   | 試合中止             |

---

## 認証・認可

### 認証方式

- OAuth 2.0（Google）
- NextAuth.js v5 使用

### 権限レベル

| 機能           | 未ログイン | ログイン済み |
| -------------- | ---------- | ------------ |
| 試合一覧閲覧   | ✓          | ✓            |
| 順位表閲覧     | ✓          | ✓            |
| チーム詳細閲覧 | ✓          | ✓            |
| お気に入り登録 | ✗          | ✓            |
| お気に入り閲覧 | ✗          | ✓            |

---

## テーマ

### ダークモード

- システム設定に連動
- 手動切り替え可能
- 設定はローカルストレージに保存

### カラースキーム

- プライマリ: 緑系（サッカーフィールドをイメージ）
- ライブ表示: 赤系（パルスアニメーション付き）
- 背景: ダークモード時は濃い青系

---

## レスポンシブ対応

| 画面サイズ                   | レイアウト                                 |
| ---------------------------- | ------------------------------------------ |
| モバイル（< 768px）          | ボトムナビゲーション、折りたたみサイドバー |
| タブレット（768px - 1024px） | コンパクトサイドバー                       |
| デスクトップ（> 1024px）     | フルサイドバー                             |

---

## API エンドポイント

### 内部API

| エンドポイント            | メソッド | 説明                       |
| ------------------------- | -------- | -------------------------- |
| `/api/favorites`          | GET      | お気に入りチーム一覧取得   |
| `/api/favorites`          | POST     | お気に入りチーム追加       |
| `/api/favorites/[teamId]` | DELETE   | お気に入りチーム削除       |
| `/api/auth/*`             | -        | NextAuth認証エンドポイント |

### 外部API（Football-Data.org）

| エンドポイント                      | 用途           |
| ----------------------------------- | -------------- |
| `/v4/competitions/{code}/matches`   | 試合一覧取得   |
| `/v4/competitions/{code}/standings` | 順位表取得     |
| `/v4/teams/{id}`                    | チーム詳細取得 |

**レート制限:** 10リクエスト/分（無料プラン）

---

## エラーハンドリング

### 表示されるエラー

| エラー種別    | 表示メッセージ                 | 対処                 |
| ------------- | ------------------------------ | -------------------- |
| API接続エラー | 「データの取得に失敗しました」 | リトライボタン表示   |
| 認証エラー    | 「認証に失敗しました」         | ログインページへ     |
| 404           | 「ページが見つかりません」     | ホームへリンク       |
| レート制限    | 「しばらくお待ちください」     | 60秒後に自動リトライ |
